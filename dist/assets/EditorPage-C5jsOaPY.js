const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AvatarCropper-BWN_9BTO.js","assets/vendor-BEfqtVUe.js","assets/utils-DxjPgW5d.js","assets/vendor-DZrYvFpI.css","assets/index-DsEmokA7.js","assets/ui-vendor-DQ8_5H5A.js","assets/state-DlvjQ27R.js","assets/lucide-react-NQr80gjg.js","assets/router-24HdL0-o.js","assets/index-CYTPKLRR.css","assets/image-crop-BdQ6hKWd.js","assets/image-crop-OEN34m2J.css"])))=>i.map(i=>d[i]);
import{j as e,r as v,u as ne,n as le}from"./vendor-BEfqtVUe.js";import{B as w,r as se,R as re,l as ie,_ as ce,L as I,I as E,k as L,m as $,c as oe,n as z,o as de,p as me,q,v as xe,s as he,t as ue,w as ge}from"./index-DsEmokA7.js";import{ar as ve,ap as je,aq as pe,a9 as fe,as as be,an as P,a3 as M,P as U}from"./lucide-react-NQr80gjg.js";import{u as te}from"./state-DlvjQ27R.js";import{d as ye}from"./utils-DxjPgW5d.js";import{c as V,C as Z,u as G,a as H,D as J,S as Y,v as Q,b as K,P as W}from"./dnd-kit-XX601_NE.js";import{S as ae}from"./select-BZTcJqOQ.js";import{b as Ne,u as Ce}from"./router-24HdL0-o.js";import"./ui-vendor-DQ8_5H5A.js";const A=({title:s,saveStatusText:r,editorPanel:t,previewPanel:a,onBack:n,headerActions:l})=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(w,{onClick:n,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"返回"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{children:e.jsxs("h1",{className:"text-lg font-semibold text-gray-900 flex items-center gap-3",children:[s,r&&e.jsx("span",{className:"text-sm font-normal text-gray-500",children:r})]})})})]}),l&&e.jsx("div",{className:"flex items-center gap-2",children:l})]})}),e.jsxs("div",{className:"flex flex-col lg:flex-row h-[calc(100vh-80px)]",children:[e.jsx("div",{className:"w-full lg:w-1/2 border-b lg:border-b-0 lg:border-r border-gray-200 bg-white h-1/2 lg:h-full overflow-y-auto",children:t}),e.jsx("div",{className:"w-full lg:w-1/2 bg-gray-50 h-1/2 lg:h-full overflow-y-auto",children:a})]})]}),B=({title:s="实时预览",description:r="左侧的修改会立即在此处显示",showFullPreview:t=!0,showZoomControls:a=!0,customPreview:n})=>{const l=te(se),[i,m]=v.useState(100),j=()=>{m(g=>Math.min(g+10,150))},d=()=>{m(g=>Math.max(g-10,50))},o=()=>{const g=`${window.location.origin}${window.location.pathname}#/preview`;window.open(g,"_blank","noopener,noreferrer")};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:s}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-gray-100 rounded-lg",children:[e.jsx(w,{onClick:d,variant:"ghost",size:"icon",className:"h-6 w-6",disabled:i<=50,children:e.jsx(je,{className:"h-3 w-3"})}),e.jsxs("span",{className:"text-xs font-medium text-gray-600 min-w-[3rem] text-center",children:[i,"%"]}),e.jsx(w,{onClick:j,variant:"ghost",size:"icon",className:"h-6 w-6",disabled:i>=150,children:e.jsx(pe,{className:"h-3 w-3"})})]}),t&&e.jsxs(w,{onClick:o,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[e.jsx(fe,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"预览 & 导出"})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-auto bg-gray-50 p-6",children:e.jsx("div",{className:"flex justify-center",children:n||e.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:e.jsx(re,{resume:l,isEditable:!1,scale:i,className:"min-h-0"})})})})]})},we=(s,r)=>{const t=v.useRef(s);v.useEffect(()=>{t.current=s});const a=v.useMemo(()=>ye((...n)=>t.current(...n),r),[r]);return v.useEffect(()=>()=>{a.cancel()},[a]),a},O=({isOpen:s,initialData:r,onSave:t,onClose:a,debounceDelay:n=500,isEqual:l=(i,m)=>JSON.stringify(i)===JSON.stringify(m)})=>{const[i,m]=v.useState(r),[j,d]=v.useState(!1),o=v.useRef(!1),g=v.useRef(i),x=v.useRef(r);v.useEffect(()=>{g.current=i},[i]);const h=we(c=>{d(!0);try{t(c),x.current=c}finally{setTimeout(()=>d(!1),300)}},n);v.useEffect(()=>{o.current&&s&&!l(i,x.current)&&h(i)},[i,s,h,l]),v.useEffect(()=>{o.current||(m(r),x.current=r,d(!1),o.current=!0)},[s,r]);const u=v.useCallback(()=>{if(o.current){const c=g.current;if(!l(c,x.current)){try{h.flush()}catch(b){console.warn("Debounce flush failed, saving directly:",b)}t(c)}}a()},[h,t,a,l]);return{data:i,setData:m,isSaving:j,handleClose:u,saveStatusText:j?"保存中...":"自动保存"}},Ie=(s,r)=>{const[t,a]=v.useState(s),[n,l]=v.useState(""),[i,m]=v.useState(!1);return{previewUrl:t,originalImageUrl:n,showCropper:i,handleFileSelect:x=>{const h=new FileReader;return h.onload=u=>{const c=u.target?.result;l(c),m(!0)},h.readAsDataURL(x),!0},handleCropSave:x=>{a(x),r?.(x),m(!1)},handleCropExisting:()=>{t&&(l(t),m(!0))},handleRemove:()=>{a(void 0),r?.("")},setShowCropper:m}},Se=({onFileSelect:s,accept:r="image/*",children:t,className:a,variant:n="outline",size:l="sm"})=>{const i=v.useRef(null),m=()=>{i.current?.click()},j=d=>{const o=d.target.files?.[0];o&&(s(o),i.current&&(i.current.value=""))};return e.jsxs(e.Fragment,{children:[e.jsx(w,{onClick:m,size:l,variant:n,className:a,children:t}),e.jsx("input",{ref:i,type:"file",accept:r,onChange:j,className:"hidden"})]})},De=ne.lazy(()=>ce(()=>import("./AvatarCropper-BWN_9BTO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),Ee=()=>e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})}),Fe=({currentAvatar:s,onAvatarChange:r})=>{const{previewUrl:t,originalImageUrl:a,showCropper:n,handleFileSelect:l,handleCropSave:i,handleCropExisting:m,handleRemove:j,setShowCropper:d}=Ie(s,r);return e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"relative",children:e.jsx(ie,{src:t,alt:"头像预览",size:"lg"})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(Se,{onFileSelect:o=>l(o),children:t?"更换头像":"选择头像"}),t&&e.jsxs(e.Fragment,{children:[e.jsxs(w,{onClick:m,size:"sm",variant:"outline",children:[e.jsx(be,{className:"h-3 w-3 mr-1"}),"裁剪"]}),e.jsx(w,{onClick:j,size:"sm",variant:"outline",children:"移除头像"})]})]}),n&&a&&e.jsx(v.Suspense,{fallback:e.jsx(Ee,{}),children:e.jsx(De,{isOpen:n,onClose:()=>d(!1),imageSrc:a,onCropComplete:i})})]})},ke=({field:s,onUpdate:r,onDelete:t})=>{const[a,n]=v.useState(!1),[l,i]=v.useState(s.label),[m,j]=v.useState(s.value),[d,o]=v.useState(s.iconName),{attributes:g,listeners:x,setNodeRef:h,transform:u,transition:c,isDragging:N}=V({id:s.id,disabled:a}),b={transform:Z.Transform.toString(u),transition:c,opacity:N?.5:1},S=()=>{r(s.id,{label:l,value:m,iconName:d}),n(!1)},f=()=>{i(s.label),j(s.value),o(s.iconName),n(!1)};return a?e.jsxs("div",{ref:h,style:b,className:"space-y-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:`label-${s.id}`,children:"字段名称"}),e.jsx(E,{id:`label-${s.id}`,value:l,onChange:p=>i(p.target.value),placeholder:"如：个人网站、GitHub等"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:`value-${s.id}`,children:"字段值"}),e.jsx(E,{id:`value-${s.id}`,value:m,onChange:p=>j(p.target.value),placeholder:"如：https://example.com"})]})]}),e.jsx("div",{children:e.jsx(L,{value:d,onChange:o,label:"图标"})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:f,children:"取消"}),e.jsx(w,{size:"sm",onClick:S,children:"保存"})]})]}):e.jsxs("div",{ref:h,style:b,className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{...g,...x,className:"cursor-move opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(P,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.label}),e.jsx("span",{className:"text-sm text-gray-600 ml-2",children:s.value})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>n(!0),children:"编辑"}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>t(s.id),children:e.jsx(M,{className:"h-4 w-4 text-red-500"})})]})]})},Pe=({id:s,label:r,type:t="text",value:a,placeholder:n,onChange:l})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:s,children:r}),e.jsx(E,{id:s,type:t,value:a,onChange:i=>l(i.target.value),placeholder:n})]}),Re=({initialData:s,onSave:r})=>{const t=G(H(W,{activationConstraint:{distance:8}})),{data:a,setData:n}=O({isOpen:!0,initialData:{...s,customFields:s.customFields||[]},onSave:r,onClose:()=>{},debounceDelay:300}),[l,i]=v.useState(null),m=(u,c)=>{n(N=>({...N,[u]:c}))},j=u=>{n(c=>({...c,avatar:u}))},d=()=>{const u={id:Date.now().toString(),label:"",value:"",icon:"star",iconName:"star"};n(c=>({...c,customFields:[...c.customFields||[],u]})),i(u.id)},o=(u,c)=>{n(N=>({...N,customFields:N.customFields?.map(b=>b.id===u?{...b,...c}:b)||[]}))},g=u=>{n(c=>({...c,customFields:c.customFields?.filter(N=>N.id!==u)||[]})),l===u&&i(null)},x=u=>{const{active:c,over:N}=u;if(!N||c.id===N.id||!a.customFields)return;const b=a.customFields.findIndex(f=>f.id===c.id),S=a.customFields.findIndex(f=>f.id===N.id);if(b!==-1&&S!==-1){const f=K(a.customFields,b,S);n(p=>({...p,customFields:f}))}},h=[{id:"name",label:"姓名",type:"text",placeholder:"请输入您的姓名"},{id:"gender",label:"性别",type:"text",placeholder:"请输入您的性别"},{id:"age",label:"年龄",type:"text",placeholder:"请输入您的年龄"},{id:"phone",label:"电话",type:"tel",placeholder:"+86 138 0013 8000"},{id:"email",label:"邮箱",type:"email",placeholder:"your.email@example.com"}];return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"编辑基本信息"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"编辑个人基本信息，包括姓名、联系方式等，所有更改将自动保存。"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{children:"头像"}),e.jsx(Fe,{currentAvatar:a.avatar,onAvatarChange:j})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.map(u=>e.jsx(Pe,{id:u.id,label:u.label,type:u.type,value:a[u.id]||"",placeholder:u.placeholder,onChange:c=>m(u.id,c)},u.id))}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{children:"自定义字段"}),e.jsxs(w,{onClick:d,size:"sm",variant:"outline",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"添加字段"]})]}),a.customFields&&a.customFields.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(P,{className:"h-3 w-3"}),"拖拽调整字段顺序"]}),e.jsx(J,{sensors:t,onDragEnd:x,children:e.jsx(Y,{items:a.customFields.map(u=>u.id),strategy:Q,children:e.jsx("div",{className:"space-y-3",children:a.customFields.map(u=>e.jsx(ke,{field:u,onUpdate:(c,N)=>o(c,N),onDelete:c=>g(c)},u.id))})})})]})]})]})})]})},Te=({sectionId:s,initialData:r,onBack:t})=>{const{handleBasicInfoSave:a}=$(s),n=l=>{a(l)};return e.jsx(A,{title:"编辑基本信息",onBack:t,editorPanel:e.jsx(Re,{initialData:r,onSave:n}),previewPanel:e.jsx(B,{title:"基本信息预览",description:"左侧的修改会立即在此处显示"})})},ze=(s,r,t,a,n)=>{const[l,i]=v.useState(!1),m=G(H(W,{activationConstraint:{distance:8}})),{data:j,setData:d,handleClose:o,saveStatusText:g}=O({isOpen:s,initialData:{items:r,selectedIcon:t,iconEnabled:!!t&&t!==""},onSave:C=>a(C.items,C.iconEnabled?C.selectedIcon:""),onClose:n,debounceDelay:500}),{items:x,selectedIcon:h,iconEnabled:u}=j,c=C=>{d({...j,items:C})},N=C=>{d({...j,selectedIcon:C})},b=C=>{d({...j,iconEnabled:C})},S=()=>{const C={id:Date.now().toString(),title:"",subtitle:"",secondarySubtitle:"",startDate:"",endDate:"",description:""};c([...x,C])},f=C=>{c(x.filter(D=>D.id!==C))},p=(C,D,R)=>{c(x.map(k=>k.id===C?{...k,[D]:R}:k))},y=C=>{const{active:D,over:R}=C;if(!R||D.id===R.id)return;const k=x.findIndex(T=>T.id===D.id),X=x.findIndex(T=>T.id===R.id);if(k!==-1&&X!==-1){const T=K(x,k,X);c(T)}},F=()=>{i(!l)};return{items:x,selectedIcon:h,iconEnabled:u,isIconSelectorOpen:l,saveStatusText:g,dragConfig:{sensors:m,onDragEnd:y,sortableItems:x.map(C=>C.id),strategy:Q},addItem:S,removeItem:f,updateItem:p,setSelectedIcon:N,setIconEnabled:b,toggleIconSelector:F,handleClose:o}},Le={toolbar:[["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],["clean"]]},$e=["bold","italic","underline","strike","color","background","list","bullet"],_=v.memo(({className:s,value:r="",onChange:t,placeholder:a="请输入内容...",readOnly:n=!1,theme:l="snow",modules:i,formats:m})=>e.jsx("div",{className:oe("w-full",s),children:e.jsx(le,{value:r,onChange:t,placeholder:a,readOnly:n,theme:l,modules:i||Le,formats:m||$e,style:{minHeight:"80px"}})}));_.displayName="Textarea";const ee=({value:s="",onChange:r,label:t,className:a="",format:n="dash-month",onFormatChange:l,showFormatSelector:i=!1})=>{const[m,j]=v.useState(n),[d,o]=v.useState(""),[g,x]=v.useState(""),[h,u]=v.useState(""),c=z.find(p=>p.value===m)||z[0];v.useEffect(()=>{j(n)},[n]),v.useEffect(()=>{if(s){const p=de(s);if(p!==s){r(p);return}const y=me(p);o(y.year),x(y.month),u(y.day)}else o(""),x(""),u("")},[s,r]);const N=v.useCallback(()=>{const p=q(d,g,h,c.hasDay);p!==s&&r(p)},[d,g,h,c.hasDay,s,r]);v.useEffect(()=>{(d||g||h)&&N()},[d,g,h,c.hasDay,N]);const b=p=>{const y=p;j(y),l?.(y)},S=v.useCallback(()=>{o(""),x(""),u(""),r("")},[r]),f=()=>!d||!g?"":ge(q(d,g,h,c.hasDay),m);return e.jsxs("div",{className:`space-y-2 ${a}`,children:[t&&e.jsx(I,{className:"text-sm font-medium text-gray-700",children:t}),i&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(I,{className:"text-xs text-gray-500",children:"日期格式"}),e.jsx(ae,{value:m,onValueChange:b,options:z.map(p=>({value:p.value,label:p.label})),className:"text-sm"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(I,{className:"text-xs text-gray-500",children:"年"}),e.jsx(E,{type:"number",value:d,onChange:p=>{const y=p.target.value;xe(y)&&o(y)},placeholder:"2025",className:"text-center",max:"9999",min:"1"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(I,{className:"text-xs text-gray-500",children:"月"}),e.jsx(E,{type:"number",value:g,onChange:p=>{const y=p.target.value;he(y)&&x(y)},placeholder:"01",min:"1",max:"12",className:"text-center"})]}),c.hasDay&&e.jsxs("div",{className:"flex-1",children:[e.jsx(I,{className:"text-xs text-gray-500",children:"日"}),e.jsx(E,{type:"number",value:h,onChange:p=>{const y=p.target.value;ue(y)&&u(y)},placeholder:"01",min:"1",max:"31",className:"text-center"})]}),(d||g||h)&&e.jsx(w,{type:"button",variant:"ghost",size:"sm",onClick:S,className:"h-8 w-8 p-0 mb-1 hover:bg-gray-100 text-gray-400 hover:text-gray-600 self-end",children:"×"})]}),f()&&e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded border",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"预览："}),e.jsx("span",{className:"ml-2 font-medium",children:f()})]})]})]})},Ae=({item:s,index:r,onUpdate:t,onRemove:a,dateFormat:n,onDateFormatChange:l})=>{const{attributes:i,listeners:m,setNodeRef:j,transform:d,transition:o,isDragging:g}=V({id:s.id}),x={transform:Z.Transform.toString(d),transition:o,opacity:g?.5:1};return e.jsxs("div",{ref:j,style:x,className:"border rounded-lg p-4 space-y-4 bg-white shadow-sm group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{...i,...m,className:"cursor-move opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(P,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("h4",{className:"font-medium text-gray-800",children:["第 ",r+1," 项"]})]}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>a(s.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(M,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{className:"text-sm font-medium text-gray-700",children:"标题"}),e.jsx(E,{value:s.title,onChange:h=>t(s.id,"title",h.target.value),placeholder:"例：项目名称、公司名称",className:"transition-all duration-200 focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{className:"text-sm font-medium text-gray-700",children:"副标题"}),e.jsx(E,{value:s.subtitle||"",onChange:h=>t(s.id,"subtitle",h.target.value),placeholder:"例：职位、专业",className:"transition-all duration-200 focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(I,{className:"text-sm font-medium text-gray-700",children:"日期格式"}),e.jsx(ae,{value:n,onValueChange:h=>l(h),options:z.map(h=>({value:h.value,label:h.label})),className:"text-sm"})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(ee,{value:s.startDate||"",onChange:h=>t(s.id,"startDate",h),label:"开始时间",format:n,showFormatSelector:!1})}),e.jsx("div",{className:"space-y-2",children:e.jsx(ee,{value:s.endDate||"",onChange:h=>t(s.id,"endDate",h),label:"结束时间",format:n,showFormatSelector:!1})}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(I,{className:"text-sm font-medium text-gray-700",children:"次要副标题"}),e.jsx(E,{value:s.secondarySubtitle||"",onChange:h=>t(s.id,"secondarySubtitle",h.target.value),placeholder:"",className:"transition-all duration-200 focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{className:"text-sm font-medium text-gray-700",children:"详细描述"}),e.jsx(_,{value:s.description,onChange:h=>t(s.id,"description",h),placeholder:"详细描述工作内容、学习经历或项目经验...",className:"transition-all duration-200 focus:ring-2 focus:ring-blue-500"})]})]})},Be=({initialData:s,onSave:r,title:t,currentIcon:a="briefcase",initialDateFormat:n="dash-month"})=>{const[l,i]=v.useState(n),m=(c,N)=>{r(c,N,l)},{items:j,selectedIcon:d,dragConfig:o,addItem:g,removeItem:x,updateItem:h,setSelectedIcon:u}=ze(!0,s,a,m,()=>{});return v.useEffect(()=>{l!==n&&m(j,d)},[l]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["编辑",t]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["在此处编辑您的",t,"信息，所有更改将自动保存。"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(L,{value:d,onChange:u,label:"图标"}),j.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(P,{className:"h-3 w-3"}),"拖拽调整项目顺序"]}),e.jsx(J,{sensors:o.sensors,onDragEnd:o.onDragEnd,children:e.jsx(Y,{items:o.sortableItems,strategy:o.strategy,children:e.jsx("div",{className:"space-y-4",children:j.map((c,N)=>e.jsx(Ae,{item:c,index:N,onUpdate:h,onRemove:x,dateFormat:l,onDateFormatChange:i},c.id))})})})]}),e.jsxs(w,{onClick:g,variant:"outline",className:"w-full border-dashed border-2 hover:bg-blue-50",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"添加一项"]})]})})]})},Oe=({section:s,onBack:r})=>{const{handleTimelineSave:t}=$(s.id),a=(n,l,i)=>{t(n,l,i)};return e.jsx(A,{title:`编辑${s.title}`,onBack:r,editorPanel:e.jsx(Be,{initialData:s.data,onSave:a,title:s.title,currentIcon:s.iconName,initialDateFormat:s.dateFormat}),previewPanel:e.jsx(B,{title:`${s.title}预览`,description:"左侧的修改会立即在此处显示"})})},_e=(s,r,t,a,n)=>{const l=G(H(W,{activationConstraint:{distance:8}})),{data:i,setData:m,handleClose:j,saveStatusText:d}=O({isOpen:s,initialData:{items:r,selectedIcon:t},onSave:f=>a(f.items,f.selectedIcon),onClose:n,debounceDelay:300}),{items:o,selectedIcon:g}=i,x=f=>{m({...i,items:f})},h=f=>{m({...i,selectedIcon:f})},u=()=>{const f={id:Date.now().toString(),content:""};x([...o,f])},c=f=>{x(o.filter(p=>p.id!==f))},N=(f,p)=>{x(o.map(y=>y.id===f?{...y,content:p}:y))},b=f=>{const{active:p,over:y}=f;if(!y||p.id===y.id)return;const F=o.findIndex(D=>D.id===p.id),C=o.findIndex(D=>D.id===y.id);if(F!==-1&&C!==-1){const D=K(o,F,C);x(D)}},S=(f,p)=>{const y=[...o],[F]=y.splice(f,1);y.splice(p,0,F),x(y)};return{items:o,selectedIcon:g,saveStatusText:d,dragConfig:{sensors:l,onDragEnd:b,sortableItems:o.map(f=>f.id),strategy:Q},addItem:u,removeItem:c,updateItem:N,moveItem:S,setSelectedIcon:h,handleClose:j}},Me=({item:s,index:r,onUpdate:t,onRemove:a})=>{const{attributes:n,listeners:l,setNodeRef:i,transform:m,transition:j,isDragging:d}=V({id:s.id}),o={transform:Z.Transform.toString(m),transition:j,opacity:d?.5:1};return e.jsxs("div",{ref:i,style:o,className:"flex items-start space-x-2 group",children:[e.jsxs("div",{className:"flex flex-col items-center mt-2",children:[e.jsx("div",{...n,...l,className:"cursor-move",children:e.jsx(P,{className:"h-4 w-4 text-gray-400"})}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:r+1})]}),e.jsx("div",{className:"flex-1",children:e.jsx(_,{value:s.content,onChange:g=>t(s.id,g),placeholder:`请输入第 ${r+1} 项内容...`,className:"min-h-[80px] resize-none"})}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>a(s.id),className:"mt-2 text-red-600 hover:text-red-700 hover:bg-red-50 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(M,{className:"h-4 w-4"})})]})},Ue=({initialData:s,onSave:r,title:t,currentIcon:a})=>{const{items:n,selectedIcon:l,dragConfig:i,addItem:m,removeItem:j,updateItem:d,setSelectedIcon:o}=_e(!0,s,a,r,()=>{});return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["编辑",t]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["在此处编辑您的",t,"信息，所有更改将自动保存。"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(L,{value:l,onChange:o,label:"图标"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"列表内容"}),e.jsxs(w,{onClick:m,size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"添加项目"]})]}),n.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(P,{className:"h-3 w-3"}),"拖拽调整项目顺序"]}),e.jsx(J,{sensors:i.sensors,onDragEnd:i.onDragEnd,children:e.jsx(Y,{items:i.sortableItems,strategy:i.strategy,children:e.jsx("div",{className:"space-y-3",children:n.map((g,x)=>e.jsx(Me,{item:g,index:x,onUpdate:d,onRemove:j},g.id))})})})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:'暂无内容，点击"添加项目"开始创建'})})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"💡 使用提示"}),e.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[e.jsx("li",{children:"• 适用于个人优势、技能特长等列表形式的内容"}),e.jsx("li",{children:"• 每一项内容会在简历中自动编号显示"}),e.jsx("li",{children:"• 可以拖拽调整项目顺序"}),e.jsx("li",{children:"• 支持多行文本，详细描述您的优势"})]})]})]})})]})},Ve=({section:s,onBack:r})=>{const{handleListSave:t}=$(s.id),a=(n,l)=>{t(n,l)};return e.jsx(A,{title:`编辑${s.title}`,onBack:r,editorPanel:e.jsx(Ue,{initialData:s.data,onSave:a,title:s.title,currentIcon:s.iconName||"list"}),previewPanel:e.jsx(B,{title:`${s.title}预览`,description:"左侧的修改会立即在此处显示"})})},Ze=(s,r,t,a,n)=>{const{data:l,setData:i,handleClose:m,saveStatusText:j}=O({isOpen:s,initialData:{content:r.content,selectedIcon:t,iconEnabled:!!t&&t!==""},onSave:b=>a({content:b.content},b.iconEnabled?b.selectedIcon:""),onClose:n,debounceDelay:300}),{content:d,selectedIcon:o,iconEnabled:g}=l,x=b=>{i({...l,content:b})},h=b=>{i({...l,selectedIcon:b})},u=b=>{i({...l,iconEnabled:b})},{wordCount:c,lineCount:N}=v.useMemo(()=>{const b=d.length,S=d.split(`
`).length;return{wordCount:b,lineCount:S}},[d]);return{content:d,selectedIcon:o,iconEnabled:g,wordCount:c,lineCount:N,saveStatusText:j,setContent:x,setSelectedIcon:h,setIconEnabled:u,handleClose:m}},Ge=({title:s,initialData:r,onSave:t,selectedIcon:a})=>{const{content:n,selectedIcon:l,iconEnabled:i,wordCount:m,lineCount:j,setContent:d,setSelectedIcon:o,setIconEnabled:g}=Ze(!0,r,a,t,()=>{});return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["编辑",s]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["在此处编辑您的",s,"信息，所有更改将自动保存。"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"icon-toggle",checked:i,onChange:x=>g(x.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),e.jsx("label",{htmlFor:"icon-toggle",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"显示模块图标"})]}),i&&e.jsx("div",{className:"pl-6 border-l-2 border-blue-100",children:e.jsx(L,{value:l,onChange:o,label:"图标"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"内容"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[m," 字符 · ",j," 行"]})]}),e.jsx(_,{value:n,onChange:x=>d(x),placeholder:"请输入内容...",className:"min-h-[300px] resize-y"})]})]})})]})},He=({section:s,onBack:r})=>{const{handleTextSave:t}=$(s.id),a=(n,l)=>{t(n,l)};return e.jsx(A,{title:`编辑${s.title}`,onBack:r,editorPanel:e.jsx(Ge,{title:s.title,initialData:s.data,onSave:a,selectedIcon:s.iconName||"file-text"}),previewPanel:e.jsx(B,{title:`${s.title}预览`,description:"左侧的修改会立即在此处显示"})})},ts=()=>{const{type:s,sectionId:r}=Ne(),t=te(se),a=Ce(),n=()=>{a("/")},l=t.sections.find(i=>i.id===r);if(v.useEffect(()=>{l||a("/")},[l,a]),!l||!s||!r)return null;switch(s){case"basic-info":return e.jsx(Te,{sectionId:r,initialData:l.data,onBack:n});case"timeline":return e.jsx(Oe,{section:l,onBack:n});case"list":return e.jsx(Ve,{section:l,onBack:n});case"text":return e.jsx(He,{section:l,onBack:n});default:return a("/"),null}};export{ts as EditorPage};
