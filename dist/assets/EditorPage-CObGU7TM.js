const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AvatarCropper-DZL6t_NI.js","assets/vendor-BEfqtVUe.js","assets/utils-DxjPgW5d.js","assets/vendor-DZrYvFpI.css","assets/index-PNspm676.js","assets/ui-vendor-DQ8_5H5A.js","assets/state-DlvjQ27R.js","assets/lucide-react-CSs-6XWH.js","assets/router-24HdL0-o.js","assets/index-cSFUeOyw.css","assets/image-crop-BdQ6hKWd.js","assets/image-crop-OEN34m2J.css"])))=>i.map(i=>d[i]);
import{j as e,r as v,u as ne,n as le}from"./vendor-BEfqtVUe.js";import{B as I,r as se,R as re,l as ie,_ as ce,L as S,I as E,k as $,m as L,c as oe,n as z,o as de,p as me,q,v as xe,s as ue,t as he,w as ge}from"./index-PNspm676.js";import{ar as ve,ap as je,aq as pe,a9 as fe,as as be,an as P,a3 as M,at as ye,au as Ne,av as Ce,aw as we,P as U}from"./lucide-react-CSs-6XWH.js";import{u as te}from"./state-DlvjQ27R.js";import{d as Ie}from"./utils-DxjPgW5d.js";import{c as V,C as Z,u as G,a as H,D as J,S as Y,v as Q,b as K,P as W}from"./dnd-kit-XX601_NE.js";import{S as ae}from"./select-Ck5-MnI1.js";import{b as Se,u as De}from"./router-24HdL0-o.js";import"./ui-vendor-DQ8_5H5A.js";const A=({title:s,saveStatusText:r,editorPanel:t,previewPanel:a,onBack:n,headerActions:l})=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(I,{onClick:n,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"返回"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{children:e.jsxs("h1",{className:"text-lg font-semibold text-gray-900 flex items-center gap-3",children:[s,r&&e.jsx("span",{className:"text-sm font-normal text-gray-500",children:r})]})})})]}),l&&e.jsx("div",{className:"flex items-center gap-2",children:l})]})}),e.jsxs("div",{className:"flex flex-col lg:flex-row h-[calc(100vh-80px)]",children:[e.jsx("div",{className:"w-full lg:w-1/2 border-b lg:border-b-0 lg:border-r border-gray-200 bg-white h-1/2 lg:h-full overflow-y-auto",children:t}),e.jsx("div",{className:"w-full lg:w-1/2 bg-gray-50 h-1/2 lg:h-full overflow-y-auto",children:a})]})]}),B=({title:s="实时预览",description:r="左侧的修改会立即在此处显示",showFullPreview:t=!0,showZoomControls:a=!0,customPreview:n})=>{const l=te(se),[i,x]=v.useState(100),j=()=>{x(g=>Math.min(g+10,150))},m=()=>{x(g=>Math.max(g-10,50))},o=()=>{const g=`${window.location.origin}${window.location.pathname}#/preview`;window.open(g,"_blank","noopener,noreferrer")};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:s}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-gray-100 rounded-lg",children:[e.jsx(I,{onClick:m,variant:"ghost",size:"icon",className:"h-6 w-6",disabled:i<=50,children:e.jsx(je,{className:"h-3 w-3"})}),e.jsxs("span",{className:"text-xs font-medium text-gray-600 min-w-[3rem] text-center",children:[i,"%"]}),e.jsx(I,{onClick:j,variant:"ghost",size:"icon",className:"h-6 w-6",disabled:i>=150,children:e.jsx(pe,{className:"h-3 w-3"})})]}),t&&e.jsxs(I,{onClick:o,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[e.jsx(fe,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"预览 & 导出"})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-auto bg-gray-50 p-6",children:e.jsx("div",{className:"flex justify-center",children:n||e.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:e.jsx(re,{resume:l,isEditable:!1,scale:i,className:"min-h-0"})})})})]})},Ee=(s,r)=>{const t=v.useRef(s);v.useEffect(()=>{t.current=s});const a=v.useMemo(()=>Ie((...n)=>t.current(...n),r),[r]);return v.useEffect(()=>()=>{a.cancel()},[a]),a},O=({isOpen:s,initialData:r,onSave:t,onClose:a,debounceDelay:n=500,isEqual:l=(i,x)=>JSON.stringify(i)===JSON.stringify(x)})=>{const[i,x]=v.useState(r),[j,m]=v.useState(!1),o=v.useRef(!1),g=v.useRef(i),u=v.useRef(r);v.useEffect(()=>{g.current=i},[i]);const h=Ee(b=>{m(!0);try{t(b),u.current=b}finally{setTimeout(()=>m(!1),300)}},n);v.useEffect(()=>{o.current&&s&&!l(i,u.current)&&h(i)},[i,s,h,l]),v.useEffect(()=>{o.current||(x(r),u.current=r,m(!1),o.current=!0)},[s,r]);const w=v.useCallback(()=>{if(o.current){const b=g.current;if(!l(b,u.current)){try{h.flush()}catch(d){console.warn("Debounce flush failed, saving directly:",d)}t(b)}}a()},[h,t,a,l]);return{data:i,setData:x,isSaving:j,handleClose:w,saveStatusText:j?"保存中...":"自动保存"}},Fe=(s,r)=>{const[t,a]=v.useState(s),[n,l]=v.useState(""),[i,x]=v.useState(!1);return{previewUrl:t,originalImageUrl:n,showCropper:i,handleFileSelect:u=>{const h=new FileReader;return h.onload=w=>{const b=w.target?.result;l(b),x(!0)},h.readAsDataURL(u),!0},handleCropSave:u=>{a(u),r?.(u),x(!1)},handleCropExisting:()=>{t&&(l(t),x(!0))},handleRemove:()=>{a(void 0),r?.("")},setShowCropper:x}},ke=({onFileSelect:s,accept:r="image/*",children:t,className:a,variant:n="outline",size:l="sm"})=>{const i=v.useRef(null),x=()=>{i.current?.click()},j=m=>{const o=m.target.files?.[0];o&&(s(o),i.current&&(i.current.value=""))};return e.jsxs(e.Fragment,{children:[e.jsx(I,{onClick:x,size:l,variant:n,className:a,children:t}),e.jsx("input",{ref:i,type:"file",accept:r,onChange:j,className:"hidden"})]})},Pe=ne.lazy(()=>ce(()=>import("./AvatarCropper-DZL6t_NI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),Re=()=>e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})}),Te=({currentAvatar:s,onAvatarChange:r})=>{const{previewUrl:t,originalImageUrl:a,showCropper:n,handleFileSelect:l,handleCropSave:i,handleCropExisting:x,handleRemove:j,setShowCropper:m}=Fe(s,r);return e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"relative",children:e.jsx(ie,{src:t,alt:"头像预览",size:"lg"})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ke,{onFileSelect:o=>l(o),children:t?"更换头像":"选择头像"}),t&&e.jsxs(e.Fragment,{children:[e.jsxs(I,{onClick:x,size:"sm",variant:"outline",children:[e.jsx(be,{className:"h-3 w-3 mr-1"}),"裁剪"]}),e.jsx(I,{onClick:j,size:"sm",variant:"outline",children:"移除头像"})]})]}),n&&a&&e.jsx(v.Suspense,{fallback:e.jsx(Re,{}),children:e.jsx(Pe,{isOpen:n,onClose:()=>m(!1),imageSrc:a,onCropComplete:i})})]})},ze=({field:s,onUpdate:r,onDelete:t})=>{const[a,n]=v.useState(!1),[l,i]=v.useState(s.label),[x,j]=v.useState(s.value),[m,o]=v.useState(s.iconName),{attributes:g,listeners:u,setNodeRef:h,transform:w,transition:b,isDragging:c}=V({id:s.id,disabled:a}),d={transform:Z.Transform.toString(w),transition:b,opacity:c?.5:1},N=()=>{r(s.id,{label:l,value:x,iconName:m}),n(!1)},y=()=>{i(s.label),j(s.value),o(s.iconName),n(!1)};return a?e.jsxs("div",{ref:h,style:d,className:"space-y-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:`label-${s.id}`,children:"字段名称"}),e.jsx(E,{id:`label-${s.id}`,value:l,onChange:p=>i(p.target.value),placeholder:"如：个人网站、GitHub等"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:`value-${s.id}`,children:"字段值"}),e.jsx(E,{id:`value-${s.id}`,value:x,onChange:p=>j(p.target.value),placeholder:"如：https://example.com"})]})]}),e.jsx("div",{children:e.jsx($,{value:m,onChange:o,label:"图标"})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:y,children:"取消"}),e.jsx(I,{size:"sm",onClick:N,children:"保存"})]})]}):e.jsxs("div",{ref:h,style:d,className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{...g,...u,className:"cursor-move opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(P,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.label}),e.jsx("span",{className:"text-sm text-gray-600 ml-2",children:s.value})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>n(!0),children:"编辑"}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>t(s.id),children:e.jsx(M,{className:"h-4 w-4 text-red-500"})})]})]})},$e=({id:s,label:r,type:t="text",value:a,placeholder:n,onChange:l})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:s,children:r}),e.jsx(E,{id:s,type:t,value:a,onChange:i=>l(i.target.value),placeholder:n})]}),Le=({initialData:s,onSave:r})=>{const t=G(H(W,{activationConstraint:{distance:8}})),{data:a,setData:n}=O({isOpen:!0,initialData:{...s,customFields:s.customFields||[]},onSave:r,onClose:()=>{},debounceDelay:300}),[l,i]=v.useState(null),x=(c,d)=>{n(N=>({...N,[c]:d}))},j=c=>{n(d=>({...d,avatar:c}))},m=()=>{const c={id:Date.now().toString(),label:"",value:"",icon:"star",iconName:"star"};n(d=>({...d,customFields:[...d.customFields||[],c]})),i(c.id)},o=(c,d)=>{n(N=>({...N,customFields:N.customFields?.map(y=>y.id===c?{...y,...d}:y)||[]}))},g=c=>{n(d=>({...d,customFields:d.customFields?.filter(N=>N.id!==c)||[]})),l===c&&i(null)},u=c=>{const{active:d,over:N}=c;if(!N||d.id===N.id||!a.customFields)return;const y=a.customFields.findIndex(f=>f.id===d.id),p=a.customFields.findIndex(f=>f.id===N.id);if(y!==-1&&p!==-1){const f=K(a.customFields,y,p);n(F=>({...F,customFields:f}))}},h=[{id:"name",label:"姓名",type:"text",placeholder:"请输入您的姓名"},{id:"gender",label:"性别",type:"text",placeholder:"请输入您的性别"},{id:"age",label:"年龄",type:"text",placeholder:"请输入您的年龄"},{id:"phone",label:"电话",type:"tel",placeholder:"+86 138 0013 8000"},{id:"email",label:"邮箱",type:"email",placeholder:"your.email@example.com"}],w=[{value:"center",label:"居中布局",icon:ye,description:"姓名居中，信息与头像左右排列"},{value:"left",label:"左对齐布局",icon:Ne,description:"头像在左，信息在右"},{value:"right",label:"右对齐布局",icon:Ce,description:"信息在左，头像在右"},{value:"classic",label:"经典布局",icon:we,description:"紧凑型，信息密集"}],b=c=>{n(d=>({...d,layout:c}))};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"编辑基本信息"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"编辑个人基本信息，包括姓名、联系方式等，所有更改将自动保存。"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{children:"布局样式"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:w.map(c=>{const d=c.icon,N=(a.layout||"center")===c.value;return e.jsxs("button",{onClick:()=>b(c.value),className:`
                      group relative flex flex-col items-start p-4 rounded-lg border-2 transition-all
                      ${N?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 bg-white hover:border-gray-300 hover:bg-gray-50"}
                    `,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(d,{className:`h-5 w-5 ${N?"text-blue-600":"text-gray-600"}`}),e.jsx("span",{className:`font-medium text-sm ${N?"text-blue-900":"text-gray-900"}`,children:c.label})]}),e.jsx("p",{className:`text-xs ${N?"text-blue-700":"text-gray-500"}`,children:c.description}),N&&e.jsx("div",{className:"absolute top-2 right-2 h-2 w-2 rounded-full bg-blue-500"})]},c.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"头像"}),e.jsx(Te,{currentAvatar:a.avatar,onAvatarChange:j})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.map(c=>e.jsx($e,{id:c.id,label:c.label,type:c.type,value:a[c.id]||"",placeholder:c.placeholder,onChange:d=>x(c.id,d)},c.id))}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(S,{children:"自定义字段"}),e.jsxs(I,{onClick:m,size:"sm",variant:"outline",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"添加字段"]})]}),a.customFields&&a.customFields.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(P,{className:"h-3 w-3"}),"拖拽调整字段顺序"]}),e.jsx(J,{sensors:t,onDragEnd:u,children:e.jsx(Y,{items:a.customFields.map(c=>c.id),strategy:Q,children:e.jsx("div",{className:"space-y-3",children:a.customFields.map(c=>e.jsx(ze,{field:c,onUpdate:(d,N)=>o(d,N),onDelete:d=>g(d)},c.id))})})})]})]})]})})]})},Ae=({sectionId:s,initialData:r,onBack:t})=>{const{handleBasicInfoSave:a}=L(s),n=l=>{a(l)};return e.jsx(A,{title:"编辑基本信息",onBack:t,editorPanel:e.jsx(Le,{initialData:r,onSave:n}),previewPanel:e.jsx(B,{title:"基本信息预览",description:"左侧的修改会立即在此处显示"})})},Be=(s,r,t,a,n)=>{const[l,i]=v.useState(!1),x=G(H(W,{activationConstraint:{distance:8}})),{data:j,setData:m,handleClose:o,saveStatusText:g}=O({isOpen:s,initialData:{items:r,selectedIcon:t,iconEnabled:!!t&&t!==""},onSave:C=>a(C.items,C.iconEnabled?C.selectedIcon:""),onClose:n,debounceDelay:500}),{items:u,selectedIcon:h,iconEnabled:w}=j,b=C=>{m({...j,items:C})},c=C=>{m({...j,selectedIcon:C})},d=C=>{m({...j,iconEnabled:C})},N=()=>{const C={id:Date.now().toString(),title:"",subtitle:"",secondarySubtitle:"",startDate:"",endDate:"",description:""};b([...u,C])},y=C=>{b(u.filter(D=>D.id!==C))},p=(C,D,R)=>{b(u.map(k=>k.id===C?{...k,[D]:R}:k))},f=C=>{const{active:D,over:R}=C;if(!R||D.id===R.id)return;const k=u.findIndex(T=>T.id===D.id),X=u.findIndex(T=>T.id===R.id);if(k!==-1&&X!==-1){const T=K(u,k,X);b(T)}},F=()=>{i(!l)};return{items:u,selectedIcon:h,iconEnabled:w,isIconSelectorOpen:l,saveStatusText:g,dragConfig:{sensors:x,onDragEnd:f,sortableItems:u.map(C=>C.id),strategy:Q},addItem:N,removeItem:y,updateItem:p,setSelectedIcon:c,setIconEnabled:d,toggleIconSelector:F,handleClose:o}},Oe={toolbar:[["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],["clean"]]},_e=["bold","italic","underline","strike","color","background","list","bullet"],_=v.memo(({className:s,value:r="",onChange:t,placeholder:a="请输入内容...",readOnly:n=!1,theme:l="snow",modules:i,formats:x})=>e.jsx("div",{className:oe("w-full",s),children:e.jsx(le,{value:r,onChange:t,placeholder:a,readOnly:n,theme:l,modules:i||Oe,formats:x||_e,style:{minHeight:"80px"}})}));_.displayName="Textarea";const ee=({value:s="",onChange:r,label:t,className:a="",format:n="dash-month",onFormatChange:l,showFormatSelector:i=!1})=>{const[x,j]=v.useState(n),[m,o]=v.useState(""),[g,u]=v.useState(""),[h,w]=v.useState(""),b=z.find(p=>p.value===x)||z[0];v.useEffect(()=>{j(n)},[n]),v.useEffect(()=>{if(s){const p=de(s);if(p!==s){r(p);return}const f=me(p);o(f.year),u(f.month),w(f.day)}else o(""),u(""),w("")},[s,r]);const c=v.useCallback(()=>{const p=q(m,g,h,b.hasDay);p!==s&&r(p)},[m,g,h,b.hasDay,s,r]);v.useEffect(()=>{(m||g||h)&&c()},[m,g,h,b.hasDay,c]);const d=p=>{const f=p;j(f),l?.(f)},N=v.useCallback(()=>{o(""),u(""),w(""),r("")},[r]),y=()=>!m||!g?"":ge(q(m,g,h,b.hasDay),x);return e.jsxs("div",{className:`space-y-2 ${a}`,children:[t&&e.jsx(S,{className:"text-sm font-medium text-gray-700",children:t}),i&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(S,{className:"text-xs text-gray-500",children:"日期格式"}),e.jsx(ae,{value:x,onValueChange:d,options:z.map(p=>({value:p.value,label:p.label})),className:"text-sm"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(S,{className:"text-xs text-gray-500",children:"年"}),e.jsx(E,{type:"number",value:m,onChange:p=>{const f=p.target.value;xe(f)&&o(f)},placeholder:"2025",className:"text-center",max:"9999",min:"1"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(S,{className:"text-xs text-gray-500",children:"月"}),e.jsx(E,{type:"number",value:g,onChange:p=>{const f=p.target.value;ue(f)&&u(f)},placeholder:"01",min:"1",max:"12",className:"text-center"})]}),b.hasDay&&e.jsxs("div",{className:"flex-1",children:[e.jsx(S,{className:"text-xs text-gray-500",children:"日"}),e.jsx(E,{type:"number",value:h,onChange:p=>{const f=p.target.value;he(f)&&w(f)},placeholder:"01",min:"1",max:"31",className:"text-center"})]}),(m||g||h)&&e.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:N,className:"h-8 w-8 p-0 mb-1 hover:bg-gray-100 text-gray-400 hover:text-gray-600 self-end",children:"×"})]}),y()&&e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded border",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"预览："}),e.jsx("span",{className:"ml-2 font-medium",children:y()})]})]})]})},Me=({item:s,index:r,onUpdate:t,onRemove:a,dateFormat:n,onDateFormatChange:l})=>{const{attributes:i,listeners:x,setNodeRef:j,transform:m,transition:o,isDragging:g}=V({id:s.id}),u={transform:Z.Transform.toString(m),transition:o,opacity:g?.5:1};return e.jsxs("div",{ref:j,style:u,className:"border rounded-lg p-4 space-y-4 bg-white shadow-sm group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{...i,...x,className:"cursor-move opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(P,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("h4",{className:"font-medium text-gray-800",children:["第 ",r+1," 项"]})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>a(s.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(M,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{className:"text-sm font-medium text-gray-700",children:"标题"}),e.jsx(E,{value:s.title,onChange:h=>t(s.id,"title",h.target.value),placeholder:"例：项目名称、公司名称",className:"transition-all duration-200 focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{className:"text-sm font-medium text-gray-700",children:"副标题"}),e.jsx(E,{value:s.subtitle||"",onChange:h=>t(s.id,"subtitle",h.target.value),placeholder:"例：职位、专业",className:"transition-all duration-200 focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(S,{className:"text-sm font-medium text-gray-700",children:"日期格式"}),e.jsx(ae,{value:n,onValueChange:h=>l(h),options:z.map(h=>({value:h.value,label:h.label})),className:"text-sm"})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(ee,{value:s.startDate||"",onChange:h=>t(s.id,"startDate",h),label:"开始时间",format:n,showFormatSelector:!1})}),e.jsx("div",{className:"space-y-2",children:e.jsx(ee,{value:s.endDate||"",onChange:h=>t(s.id,"endDate",h),label:"结束时间",format:n,showFormatSelector:!1})}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(S,{className:"text-sm font-medium text-gray-700",children:"次要副标题"}),e.jsx(E,{value:s.secondarySubtitle||"",onChange:h=>t(s.id,"secondarySubtitle",h.target.value),placeholder:"",className:"transition-all duration-200 focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{className:"text-sm font-medium text-gray-700",children:"详细描述"}),e.jsx(_,{value:s.description,onChange:h=>t(s.id,"description",h),placeholder:"详细描述工作内容、学习经历或项目经验...",className:"transition-all duration-200 focus:ring-2 focus:ring-blue-500"})]})]})},Ue=({initialData:s,onSave:r,title:t,currentIcon:a="briefcase",initialDateFormat:n="dash-month"})=>{const[l,i]=v.useState(n),x=(b,c)=>{r(b,c,l)},{items:j,selectedIcon:m,dragConfig:o,addItem:g,removeItem:u,updateItem:h,setSelectedIcon:w}=Be(!0,s,a,x,()=>{});return v.useEffect(()=>{l!==n&&x(j,m)},[l]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["编辑",t]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["在此处编辑您的",t,"信息，所有更改将自动保存。"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{value:m,onChange:w,label:"图标"}),j.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(P,{className:"h-3 w-3"}),"拖拽调整项目顺序"]}),e.jsx(J,{sensors:o.sensors,onDragEnd:o.onDragEnd,children:e.jsx(Y,{items:o.sortableItems,strategy:o.strategy,children:e.jsx("div",{className:"space-y-4",children:j.map((b,c)=>e.jsx(Me,{item:b,index:c,onUpdate:h,onRemove:u,dateFormat:l,onDateFormatChange:i},b.id))})})})]}),e.jsxs(I,{onClick:g,variant:"outline",className:"w-full border-dashed border-2 hover:bg-blue-50",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"添加一项"]})]})})]})},Ve=({section:s,onBack:r})=>{const{handleTimelineSave:t}=L(s.id),a=(n,l,i)=>{t(n,l,i)};return e.jsx(A,{title:`编辑${s.title}`,onBack:r,editorPanel:e.jsx(Ue,{initialData:s.data,onSave:a,title:s.title,currentIcon:s.iconName,initialDateFormat:s.dateFormat}),previewPanel:e.jsx(B,{title:`${s.title}预览`,description:"左侧的修改会立即在此处显示"})})},Ze=(s,r,t,a,n)=>{const l=G(H(W,{activationConstraint:{distance:8}})),{data:i,setData:x,handleClose:j,saveStatusText:m}=O({isOpen:s,initialData:{items:r,selectedIcon:t},onSave:y=>a(y.items,y.selectedIcon),onClose:n,debounceDelay:300}),{items:o,selectedIcon:g}=i,u=y=>{x({...i,items:y})},h=y=>{x({...i,selectedIcon:y})},w=()=>{const y={id:Date.now().toString(),content:""};u([...o,y])},b=y=>{u(o.filter(p=>p.id!==y))},c=(y,p)=>{u(o.map(f=>f.id===y?{...f,content:p}:f))},d=y=>{const{active:p,over:f}=y;if(!f||p.id===f.id)return;const F=o.findIndex(D=>D.id===p.id),C=o.findIndex(D=>D.id===f.id);if(F!==-1&&C!==-1){const D=K(o,F,C);u(D)}},N=(y,p)=>{const f=[...o],[F]=f.splice(y,1);f.splice(p,0,F),u(f)};return{items:o,selectedIcon:g,saveStatusText:m,dragConfig:{sensors:l,onDragEnd:d,sortableItems:o.map(y=>y.id),strategy:Q},addItem:w,removeItem:b,updateItem:c,moveItem:N,setSelectedIcon:h,handleClose:j}},Ge=({item:s,index:r,onUpdate:t,onRemove:a})=>{const{attributes:n,listeners:l,setNodeRef:i,transform:x,transition:j,isDragging:m}=V({id:s.id}),o={transform:Z.Transform.toString(x),transition:j,opacity:m?.5:1};return e.jsxs("div",{ref:i,style:o,className:"flex items-start space-x-2 group",children:[e.jsxs("div",{className:"flex flex-col items-center mt-2",children:[e.jsx("div",{...n,...l,className:"cursor-move",children:e.jsx(P,{className:"h-4 w-4 text-gray-400"})}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:r+1})]}),e.jsx("div",{className:"flex-1",children:e.jsx(_,{value:s.content,onChange:g=>t(s.id,g),placeholder:`请输入第 ${r+1} 项内容...`,className:"min-h-[80px] resize-none"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>a(s.id),className:"mt-2 text-red-600 hover:text-red-700 hover:bg-red-50 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(M,{className:"h-4 w-4"})})]})},He=({initialData:s,onSave:r,title:t,currentIcon:a})=>{const{items:n,selectedIcon:l,dragConfig:i,addItem:x,removeItem:j,updateItem:m,setSelectedIcon:o}=Ze(!0,s,a,r,()=>{});return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["编辑",t]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["在此处编辑您的",t,"信息，所有更改将自动保存。"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{value:l,onChange:o,label:"图标"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"列表内容"}),e.jsxs(I,{onClick:x,size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"添加项目"]})]}),n.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(P,{className:"h-3 w-3"}),"拖拽调整项目顺序"]}),e.jsx(J,{sensors:i.sensors,onDragEnd:i.onDragEnd,children:e.jsx(Y,{items:i.sortableItems,strategy:i.strategy,children:e.jsx("div",{className:"space-y-3",children:n.map((g,u)=>e.jsx(Ge,{item:g,index:u,onUpdate:m,onRemove:j},g.id))})})})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:'暂无内容，点击"添加项目"开始创建'})})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"💡 使用提示"}),e.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[e.jsx("li",{children:"• 适用于个人优势、技能特长等列表形式的内容"}),e.jsx("li",{children:"• 每一项内容会在简历中自动编号显示"}),e.jsx("li",{children:"• 可以拖拽调整项目顺序"}),e.jsx("li",{children:"• 支持多行文本，详细描述您的优势"})]})]})]})})]})},Je=({section:s,onBack:r})=>{const{handleListSave:t}=L(s.id),a=(n,l)=>{t(n,l)};return e.jsx(A,{title:`编辑${s.title}`,onBack:r,editorPanel:e.jsx(He,{initialData:s.data,onSave:a,title:s.title,currentIcon:s.iconName||"list"}),previewPanel:e.jsx(B,{title:`${s.title}预览`,description:"左侧的修改会立即在此处显示"})})},Ye=(s,r,t,a,n)=>{const{data:l,setData:i,handleClose:x,saveStatusText:j}=O({isOpen:s,initialData:{content:r.content,selectedIcon:t,iconEnabled:!!t&&t!==""},onSave:d=>a({content:d.content},d.iconEnabled?d.selectedIcon:""),onClose:n,debounceDelay:300}),{content:m,selectedIcon:o,iconEnabled:g}=l,u=d=>{i({...l,content:d})},h=d=>{i({...l,selectedIcon:d})},w=d=>{i({...l,iconEnabled:d})},{wordCount:b,lineCount:c}=v.useMemo(()=>{const d=m.length,N=m.split(`
`).length;return{wordCount:d,lineCount:N}},[m]);return{content:m,selectedIcon:o,iconEnabled:g,wordCount:b,lineCount:c,saveStatusText:j,setContent:u,setSelectedIcon:h,setIconEnabled:w,handleClose:x}},Qe=({title:s,initialData:r,onSave:t,selectedIcon:a})=>{const{content:n,selectedIcon:l,iconEnabled:i,wordCount:x,lineCount:j,setContent:m,setSelectedIcon:o,setIconEnabled:g}=Ye(!0,r,a,t,()=>{});return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["编辑",s]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["在此处编辑您的",s,"信息，所有更改将自动保存。"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"icon-toggle",checked:i,onChange:u=>g(u.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),e.jsx("label",{htmlFor:"icon-toggle",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"显示模块图标"})]}),i&&e.jsx("div",{className:"pl-6 border-l-2 border-blue-100",children:e.jsx($,{value:l,onChange:o,label:"图标"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"内容"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[x," 字符 · ",j," 行"]})]}),e.jsx(_,{value:n,onChange:u=>m(u),placeholder:"请输入内容...",className:"min-h-[300px] resize-y"})]})]})})]})},Ke=({section:s,onBack:r})=>{const{handleTextSave:t}=L(s.id),a=(n,l)=>{t(n,l)};return e.jsx(A,{title:`编辑${s.title}`,onBack:r,editorPanel:e.jsx(Qe,{title:s.title,initialData:s.data,onSave:a,selectedIcon:s.iconName||"file-text"}),previewPanel:e.jsx(B,{title:`${s.title}预览`,description:"左侧的修改会立即在此处显示"})})},rs=()=>{const{type:s,sectionId:r}=Se(),t=te(se),a=De(),n=()=>{a("/")},l=t.sections.find(i=>i.id===r);if(v.useEffect(()=>{l||a("/")},[l,a]),!l||!s||!r)return null;switch(s){case"basic-info":return e.jsx(Ae,{sectionId:r,initialData:l.data,onBack:n});case"timeline":return e.jsx(Ve,{section:l,onBack:n});case"list":return e.jsx(Je,{section:l,onBack:n});case"text":return e.jsx(Ke,{section:l,onBack:n});default:return a("/"),null}};export{rs as EditorPage};
